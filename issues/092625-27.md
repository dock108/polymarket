# Issue 092625-27: Deployment – Backend Release Pipeline

**Priority**: High  
**Component**: DevOps / CD  
**Beta Blocker**: Yes (deploy to Hetzner)  
**Discovered**: 2025-09-26  
**Status**: New  
**Resolved**: 

## Problem Description

Create a container release pipeline that publishes images and deploys via compose (or Kamal) on the Hetzner VPS, with environment variables and secrets.

## Investigation Areas

1. Container registry choice and auth  
2. Compose/Kamal deployment commands and service definitions  
3. Secret management strategy on server  

## Expected Behavior

A tagged release builds and pushes the API image and updates the running services on the VPS with minimal downtime.

## Files to Investigate

- `docker-compose.yml`  
- `.github/workflows/release.yml` (to be added)  
- `deploy/scripts/deploy.sh` (to be added)  

## Root Cause Analysis

1. **Primary Cause**: No automated release yet.  
2. **Contributing Factors**: First-time infra setup.  
3. **Why It Happened**: Pre-deployment state.  

## Solution Implemented

### 1. Release Workflow (⏳ In Progress)
- Build, tag, push; SSH to server and pull+restart stack.  

### Code Changes

**File Modified**: `N/A - new workflow/scripts will be added`

**Before**:
```text
Manual ad-hoc deployments.
```

**After**:
```text
.github/workflows/release.yml
deploy/scripts/deploy.sh
```

## Testing Requirements

### Manual Testing Steps
1. Trigger a tagged release; verify new container runs in prod.  
2. Roll back by redeploying previous tag.  

### Test Scenarios
- [ ] Secrets loaded correctly  
- [ ] Zero/low-downtime observed  

## Status

**Current Status**: Planned  
**Last Updated**: 2025-09-26

### Implementation Checklist
- [ ] Configure registry and secrets  
- [ ] Add workflows and scripts  
- [ ] Test deploy and rollback  

### Completion Criteria (Ready for User Testing)
- [ ] Release pipeline deploys cleanly  
- [ ] Ready for user testing  
- [ ] Any blockers clearly documented  

### User Testing Confirmation
- [ ] User confirms release flow and access  
- [ ] User approves moving to done/complete  

## Result

Automated container release and deploy process for backend API.

---

## User Confirmation & Actions Required

- Provide registry and credentials; server SSH access.  
- Confirm environment variable values for prod.  

## Definition of Done (including user confirmations)

- Pipeline configured and validated.  
- User confirms secrets and deploy flow.
