# Issue 092625-13: DG +EV Computation and Labeling

**Priority**: High  
**Component**: Backend / Golf Analytics  
**Beta Blocker**: Yes (Golf tab requires EV)  
**Discovered**: 2025-09-26  
**Status**: New  
**Resolved**: 

## Problem Description

Compute expected value for golf bets using DataGolf win probabilities against market odds (sportsbook and Polymarket), and label +EV opportunities.

## Investigation Areas

1. EV formula and stake/payout assumptions.  
2. Mapping golfers to market outcomes (naming, ids).  
3. Thresholds for highlighting +EV in UI.  

## Expected Behavior

For each golfer and event with available odds, we compute EV and flag `DG+EV` when EV > threshold; include supporting fields for UI.

## Files to Investigate

- `backend/app/services/datagolf.py`  
- `backend/app/services/odds_api.py`  
- `backend/app/utils/odds.py`  

## Root Cause Analysis

1. **Primary Cause**: EV logic not yet implemented.  
2. **Contributing Factors**: Joining DG data with market odds.  
3. **Why It Happened**: Follows after integrations.  

## Solution Implemented

### 1. EV Computation and Labels (⏳ In Progress)
- For each golfer, compute EV vs available odds; set `dg_positive_ev=true` when EV > 0 (configurable threshold).  

### Code Changes

**File Modified**: `backend/app/services/datagolf.py` (or aggregator)

**Before**:
```text
No EV labeling.
```

**After**:
```text
EV fields computed and positive EV labeling for golfers.
```

## Testing Requirements

### Manual Testing Steps
1. Select sample event; verify a few golfers’ EV manually.  
2. Confirm labels match computed values.  

### Test Scenarios
- [ ] EV > 0 labeled as +EV  
- [ ] Threshold toggle affects labeling  

## Status

**Current Status**: Planned  
**Last Updated**: 2025-09-26

### Implementation Checklist
- [ ] Join DG probabilities with odds  
- [ ] Compute EV per golfer  
- [ ] Apply threshold and label  

### Completion Criteria (Ready for User Testing)
- [ ] EV outputs visible via API  
- [ ] Ready for user testing  
- [ ] Any blockers clearly documented  

### User Testing Confirmation
- [ ] User validates EV math and labels on sample  
- [ ] User approves moving to done/complete  

## Result

DG-based EV labeling available for Golf tab filtering and highlighting.

---

## User Confirmation & Actions Required

- Confirm EV threshold default for +EV highlighting.  
- Confirm stake baseline ($1) and display format.  

## Definition of Done (including user confirmations)

- EV computed and labels applied.  
- User confirms threshold and presentation.
