# Issue 092625-26: Deployment – Nginx Reverse Proxy + HTTPS

**Priority**: High  
**Component**: DevOps / Deployment  
**Beta Blocker**: Yes (secure access to API)  
**Discovered**: 2025-09-26  
**Status**: New  
**Resolved**: 

## Problem Description

Provision Nginx as a reverse proxy in front of FastAPI with HTTPS via Let's Encrypt, including health checks and logging for Hetzner deployment.

## Investigation Areas

1. Nginx config for ASGI upstream and timeouts  
2. Certbot/LE auto-renew on Hetzner  
3. Access/error log rotation  

## Expected Behavior

Public domain serves HTTPS; Nginx proxies to API; health endpoint is exposed; logs are rotated and accessible.

## Files to Investigate

- `deploy/nginx/nginx.conf` (to be added)  
- `deploy/scripts/*` (to be added)  

## Root Cause Analysis

1. **Primary Cause**: No reverse proxy/HTTPS yet.  
2. **Contributing Factors**: Bare VPS needs first-time setup.  
3. **Why It Happened**: Pre-deployment phase.  

## Solution Implemented

### 1. Nginx + TLS (⏳ In Progress)
- Configure Nginx site; obtain LE cert; add renew timer.  

### Code Changes

**File Modified**: `N/A - new deploy files will be added`

**Before**:
```text
No HTTPS deployment.
```

**After**:
```text
deploy/nginx/nginx.conf
deploy/scripts/provision_nginx.sh
```

## Testing Requirements

### Manual Testing Steps
1. Curl `https://<domain>/health` returns 200.  
2. Check cert validity and renew cron/timer.  

### Test Scenarios
- [ ] TLS valid and modern ciphers  
- [ ] Logs rotate successfully  

## Status

**Current Status**: Planned  
**Last Updated**: 2025-09-26

### Implementation Checklist
- [ ] Provision Nginx  
- [ ] Configure LE cert and renew  
- [ ] Add healthcheck and logs  

### Completion Criteria (Ready for User Testing)
- [ ] HTTPS enabled and stable  
- [ ] Ready for user testing  
- [ ] Any blockers clearly documented  

### User Testing Confirmation
- [ ] User verifies HTTPS endpoint works  
- [ ] User approves moving to done/complete  

## Result

Secure public access to API via Nginx with TLS on Hetzner.

---

## User Confirmation & Actions Required

- Provide domain and DNS pointing to the VPS IP.  
- Confirm preferred TLS settings and endpoint paths.  

## Definition of Done (including user confirmations)

- Nginx + TLS configured and validated.  
- User confirms domain/DNS and HTTPS behavior.
