# Issue 092825-1: Sports Directory – Datasets and Loaders (Leagues/Teams/Aliases)

**Priority**: High  
**Component**: Backend / Data Directory  
**Beta Blocker**: No (post-UAT), but enables accurate parsing  
**Discovered**: 2025-09-28  
**Status**: New  
**Resolved**: 

## Problem Description

We need a comprehensive, maintainable sports directory spanning leagues (≈10+) and hundreds of teams with cities, names, abbreviations, aliases, and conference/division metadata. Current lightweight mapping is insufficient for production-grade parsing across diverse market text.

## Investigation Areas

1. Identify authoritative sources per league (NBA/MLB/NHL/NFL/NCAAB/NCAAF/MLS/EPL/UEFA/etc.).  
2. Determine fields and schema for CSV snapshots (team_key, city, name, full_name, abbrev(s), aliases[], conference/division).  
3. Design loader that merges multiple sources and outputs normalized structures.

## Expected Behavior

A versioned dataset under `data/sports/` containing CSVs/JSON snapshots per league. A loader utility that exposes fast lookups (by name/alias/abbrev) and supports future merges with external APIs.

## Files to Investigate

- `backend/app/utils/sports_config.py` (seed)  
- New directory `data/sports/`  
- New loader in `backend/app/utils/`

## Solution Implemented

### 1. Dataset Scaffolding (⏳ Planned)
- Create `data/sports/{league}_teams.csv` for target leagues (start: NBA, MLB, NHL, NFL; expand later).  
- Define canonical `team_key`, `league`, `city`, `name`, `full_name`, `abbr`, `aliases` (pipe-delimited), `conference`, `division`.

### 2. Loader Utility (⏳ Planned)
- Implement `SportsDirectory` to read CSVs, build exact/alias/abbr indices, and expose `find_team`, `list_league_teams`.

### Code Changes

**Files Added**:  
- `data/sports/` CSVs for initial leagues  
- `backend/app/utils/sports_directory.py` (loader)

**Before**:
```text
Ad-hoc small mapping, limited coverage.
```

**After**:
```text
Structured datasets and a loader utility for robust, cross-league lookups.
```

## Testing Requirements

### Manual Testing Steps
1. Load directory and query 3–5 teams per league by city/name/abbrev; confirm canonical keys.  
2. Validate conferences/divisions return as expected.

### Test Scenarios
- [ ] Exact name, alias, and abbreviation hits return same team_key.  
- [ ] Unknown team returns None gracefully.  
- [ ] League isolation enforced.

## Status

**Current Status**: Planned  
**Last Updated**: 2025-09-28

### Implementation Checklist
- [ ] Create CSV schema and seed data for NBA/MLB/NHL/NFL  
- [ ] Implement loader with indices  
- [ ] Unit tests for loader

### Completion Criteria (Ready for User Testing)
- [ ] Datasets present and documented  
- [ ] Loader returns correct keys for sample queries  
- [ ] Tests pass

### User Testing Confirmation
- [ ] User validates directory coverage for target leagues  
- [ ] User approves moving to done/complete

### User Confirmation & Actions Required
- Provide target league list priority and any preferred abbreviations/alias overrides.

## Result

[TBD]
